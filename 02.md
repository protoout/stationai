# Gemini CLIでバイブコーディングする準備を整える

Manusを利用して作成したアプリの雛形を、GitHub Codespaces上で改変するための準備を進めます。

Manusのフリープランでは利用できるトークン量に限りがあること、他の手段との連携、より柔軟な変更も可能、などの理由からここからはAIコーディングエージェントに開発を引き継いで体験してもらいます。

OpenAI（ChatGPT）のCodex、Claude Code、GitHub Copilotなど色々なツールがありますが、今回は無料の範囲で検証しやすい`Gemini CLI`を利用します。 

## 1. このセクションの目標

Manusで実装した雛形をGitHub Codespacesに移植し、バイブコーディングする準備を整える

- Manusが生成したファイル一式をGitHubのリポジトリにコピーする
- 作成したリポジトリでCodespaceを立ち上げ、Gemini CLIを使えるようにする
- 移植したファイルをプログラムから実行し、Manusと同様のアプリが再現されることを確認する

## 2. ハンズオン

> [!NOTE]
> ここからは開発の場をManusからGitHubとGemini CLIに移します  
> 上記の通り、Manusのフリープランでは利用できるトークン量に限りがあるためです  
> `Manus`: モバイルアプリをバイブコーディングするための下地・雛形の作成  
> `GitHub`: モバイルアプリのコードの管理  
> `Gemini CLI`: モバイルアプリへの機能追加・改修  
> という役割分担をイメージするとわかりやすいと思います
  
> [!WARNING]
> 難易度上がります！注意レベル上げていきましょう！  
> Manusは万人に使える親切な環境（その分お金がかかる）でしたが、ここからは実際に開発する職種の人も利用する環境です  
> 1文字の誤りで動かないことも発生します  
> **書いてある手順を遵守する**、**コピペできるところはコピペする**ということを再度意識しましょう

### 3.2.1. Manusで作成したアプリをGitHubに連携

まずはManusで作成したアプリの雛形を、ご自身のGitHubアカウントに移植します。

- Manusの画面右上。GitHubのアイコンが描かれたボタンを押します

> <img src="https://i.gyazo.com/21cd0c840b62c338b387a4877c292017.png" alt="gyazo.png" width="450px" />
>
> 黒丸に白抜きの猫のアイコンが`GitHub`のアイコンです

- 開いたメニューにある`Connect`のボタンを押します

> <img src="https://i.gyazo.com/2602df080f128aaca2163ecce0acd09a.png" alt="gyazo.png" width="450px" />

- さらにダイアログが開くので、`+ Connect`ボタンを押して進みます

> <img src="https://i.gyazo.com/ff808f0d72c2ad469f0426915cf20b41.png" alt="gyazo.png" width="450px" />

- ManusとGitHubを接続する準備が進みます。`Authorize Manus Connector`ボタンを押して進んでください

> <img src="https://i.gyazo.com/d286ffe570837d660e3ca4593ff61f04.png" alt="gyazo.png" width="450px" />
>
> ここからGitHubのログイン手続きが進みますので、画面に従って進めてください

- `Authorize Account`に✔️が入ります
- Repositoryを追加して良いか聞かれます。`Add Repositories`ボタンを押して進んでください

> <img src="https://i.gyazo.com/2d8df6120d5cc6d592789d65a3bc9dc6.png" alt="gyazo.png" width="450px" />
>
> ここからGitHubが別タブで開きます

- GitHubの画面が別タブで開いて遷移します
- Manusとの接続を設定する画面になります

> **① ハンズオンで初めてGitHubを利用される方**  
> `All repositories`を選んで`save`を押してしまって構いません  
>
> **② GitHubを利用したことある方**  
> 別のrepositoryを作成している場合、`Only select repositories`を選択。Manusにアクセスされても問題ないrepositoryを選んで`save`  
> 他のrepositoryがない場合は`All repositories`を選んで`save`
>
> <img src="https://i.gyazo.com/f55f1a02c6c71a988a19cb87678f66fe.png" alt="gyazo.png" width="450px" />
>
> 何らかのrepositoryをManus側に共有しないと`save`ボタンが押せません

- 次の画面になれば接続成功です

> <img src="https://i.gyazo.com/b51d9046c4a7b9887addc643cc075d46.png" alt="gyazo.png" width="450px" />
>
> Manusとご自身のGitHubが接続された状態。

- 完了したらManus側のタブに戻ります
- 再度GitHubのアイコンが描かれたボタンを押すと、`Owner`を選択する箇所があるので、ご自身のGitHubアカウント名を選びます
- `Repository name`も変更できます。デフォルトではManusが命名した名前が記載されています

> <img src="https://i.gyazo.com/fc437e96b9afd7a4ba8c8cbf896af01b.png" alt="gyazo.png" width="450px" />

- 選択すると`Create repository`のボタンが押せるようになります
- 押下するとGitHubへの連携作業が開始されます

> <img src="https://i.gyazo.com/191f574e0883624043eeecc01e014c12.png" alt="gyazo.png" width="450px" />

- 緑色の⚫︎に`Up to date`の文字が表示されていれば成功です

> 赤枠内をクリックしてGitHubに遷移します  
> <img src="https://i.gyazo.com/2225009126c25c300a0651cc899126e8.png" alt="gyazo.png" width="450px" />

- 命名したRepository nameと同じ名前のRepositoryに遷移すれば成功です

> <img src="https://i.gyazo.com/e80ab20548168f3d02f5010f283b8488.png" alt="gyazo.png" width="450px" />

#### 3.2.1.1 GitHub Codespacesのタイムアウト時間設定を伸ばす（余力ある人は実施）

スキップしてもOKです。時間余裕ある人は実施しましょう。

GitHub Codespacesはデフォルトだと30分ほどでサスペンド（一時停止）してしまいます。これを回避するためにGitHub Codespacesの設定を変更して2時間（120分）まで延長しておきましょう。最大4時間まで延長できます。

[こちら](https://github.com/settings/codespaces#default-idle-timeout-header)から設定できます。

> 最大だと240分です。
>
> <img src="https://i.gyazo.com/0258599c9954e76fcf000cb23a71d54c.png" alt="gyazo.png" width="450px" />

### 3.2.2. GitHub Codespacesの立ち上げ

ここから実際にバイブコーディングを進める環境の、GitHub Codespaceを立ち上げます

- 緑色の`< > Code ▼`ボタンを押し、続けて`Create codespace on main`を押すとCodespaceが立ち上がります

> <img src="https://i.gyazo.com/f3cf14bd531dae8826c4ba5ddc8b453c.png" alt="gyazo.png" width="450px" />
  
- 空のCodespaceではないので少し時間がかかります

> [!WARNING]
> 立ち上げている間、Codespaceのタブはアクティブな状態（別のタブで隠れていない状態）にしておきましょう（立ち上げが遅くなります）

- 途中、次のような警告が出るかもしれませんが`今後表示しない`を押してしまって構いません

> <img src="https://i.gyazo.com/d958039ea1be83115fdc84c7bf096351.png" alt="gyazo.png" width="450px" />

- 次の画面のような状態になれば成功です

> <img src="https://i.gyazo.com/add722b80f35c29d3cd8c2576256e298.png" alt="gyazo.png" width="450px" />

- 画面右側のサイドバーにある`チャット`は本日利用しないので`×`で閉じてしまって構いません

> <img src="https://i.gyazo.com/6bbeb1c3b3c638e0e48fb04bfae57fa3.png" alt="gyazo.png" width="450px" />

### 3.2.3. バイブコーディング前の準備

それではここから、実際にGitHub Codespaces上でバイブコーディングするための準備を進めます。

#### 3.2.3.1. 画面の説明（説明のみ）

バイブコーディングを進める前に画面の各エリアの説明です。

> <img src="https://i.gyazo.com/e8e8f7e9464b3bd610154a2c7038ee3e.png" alt="gyazo.png" width="450px" />

- エクスプローラー（赤枠）: ファイルの一覧が表示されます。ここに作成したプログラムやフォルダが表示されます
- エディタ（黄色枠）: ファイルの編集を行う画面です。今回はおそらく自身では触りませんがプログラムの編集過程が表示されます
- **ターミナル（紫枠）**: コマンドを実行したり、AIと会話したりするエリアです。多少作業が発生します。 **次の章で利用**

各エリアをクリックして操作するエリアを切り替えられます。

#### 3.2.3.2. Codespacesの確認とターミナルの練習

- 立ち上げたCodespaceの状態を確認します
- ターミナル操作の練習をかねて、次のコマンドを**それぞれ**ターミナルに貼り付け。`Enter`を押して実行してみましょう

> **コマンド1つ目**

```sh
which pnpm
```

- `/home/codespace/nvm/current/bin/pnpm`と表示されれば成功

> **コマンド2つ目**

```sh
pnpm --version
```

- `9.12.0`のような数字が出れば成功（実行した時期によって数字は異なります）

> [!WARNING]
> もし`bash: pnpm: command not found`のようなメッセージが出てしまった場合、**コピペミスなどないか確認**  
> それでも間違っていない場合、事務局まで連絡してください

> 成功例
>
> <img src="https://i.gyazo.com/818e10d274ef5854df34a1f81ae8639c.png" alt="gyazo.png" width="450px" />

#### 3.2.3.3 Gemini CLI の準備

これから利用していくGemini CLIの準備を進めます

- 次のコマンドをコピー。ターミナルをクリックして貼り付けて`Enter`を押してください。

```sh
npm install -g @google/gemini-cli@latest
```

- 画像のように表示されれば成功しています。

> <img src="https://i.gyazo.com/8dfff8cf7b00f796a9a05f753cacbb7e.png" alt="gyazo.png" width="450px" />

- 続けて次のコマンドをコピー。同じく、ターミナルに貼り付けて`Enter`。

```sh
gemini
```

> `gemini`を入力した状態
>
> <img src="https://i.gyazo.com/5f81855547fa59eeab8c662415eac647.png" alt="gyazo.png" width="450px" />

- Gemini CLIが起動します。
- ターミナルを選択した状態で、矢印キーとEnterで進めることができます。
- `1. Yes`を選択（⚫︎がついている状態に）して`Enter`

> <img src="https://i.gyazo.com/837974b44f8e48c6048499c8fc750219.png" alt="gyazo.png" width="450px" />

- 本ハンズオンでは事前に準備していただいたGoogleのアカウントで進めます。
- `1. Login with Google`を選択して`Enter`

> <img src="https://i.gyazo.com/4d3326eae6130662e09501e4c0dd3a84.png" alt="gyazo.png" width="450px" />

- 認証を行います。赤枠をwindowsの方は`ctrl`、macの方は`command`を押した状態でクリックしてください。

> <img src="https://i.gyazo.com/a9ef037ebcd166f78b9952a3c58b19db.png" alt="gyazo.png" width="450px" />

- 開いて問題ないか確認されるので、`開く`を押してください

> **Googleのログイン画面が開くので、画面の指示に従い進めてください。**  
> ログインに成功すると次の画面に遷移します。  
> <img src="https://i.gyazo.com/3af01339d624a5663652def5b8c47c1c.png" alt="gyazo.png" width="450px" />
>
> グレー枠の中にある認証コードをターミナルに入力します。
> `Copy`を押すとコピーできます

- ターミナルに戻り、コピーしたコードを貼り付けましょう

> <img src="https://i.gyazo.com/65ee6eef4918caba0822e2baf3d8c1e9.png" alt="gyazo.png" width="450px" />
>
> 正しく貼り付けられると、赤枠のような状態になります。

- この状態で`Enter`を押します
- 次のような画面になれば成功です

> <img src="https://i.gyazo.com/e28d8089e758eed5a0b900293e6d2e0a.png" alt="gyazo.png" width="450px" />

- `>` に続けて文字を入力することができます。
- `hello`のように、簡単な挨拶文を入力して`Enter`を押しましょう

> <img src="https://i.gyazo.com/bf71300e5ecc19f8f6148d71471efc80.png" alt="gyazo.png" width="450px" />
>
> Geminiから応答が返ってきます。  
> 必ずしも英語である必要はありません。

#### 3.2.3.4. Gemini CLI の停止

練習も兼ねて、Gemini CLIを一旦停止します。  
Gemini CLIの入力欄に `/`を入力します。すると、さまざまなオプション機能を選んで実行することができます（slash commandというので、興味あれば調べてみてください）。

> <img src="https://i.gyazo.com/d183efd8b60f75e8f86d93065886c337.png" alt="gyazo.png" width="450px" />
>
> `/`を入力することで、slash commandの候補が表示されます。

- `/`に続けて`q`を入力します。すると候補として`quit`が表示されます。

> <img src="https://i.gyazo.com/54ec3da963de4e295df4e7ce67d21f59.png" alt="gyazo.png" width="450px" />
>
> `q`から始まるコマンドの候補が表示されている状態

- この状態で`tab`キーを押すと`/quit`が入力されます。
- `/quit`が入力された状態で`Enter`を押すと、Gemini CLIが終了し、通常のターミナルに戻ります

> <img src="https://i.gyazo.com/0de75cac12d49db79ce305ea5b3c4138.png" alt="gyazo.png" width="450px" />
>
> 通常のターミナルが開いている状態。  
> Geminiへの命令文ではない通常のコマンドはこの状態で打ち込みましょう。

- 通常のターミナルが開いている状態で再度`gemini`を入力して`Enter`を押すことでGemini CLIが起動します。
- 何回か停止と起動を繰り返して練習してみましょう。

### 3.2.4. 移植したアプリの確認

この章の最後として、Manusから移植したアプリの動作を確認します。  
ターミナルに次のコマンドをコピー・ペーストしたのち、`Enter`で実行してください。

```sh
pnpm dev:metro
```

- このコマンドを入力すると、先ほどまでのように文字や数字が表示されて終わりとはなりません
- 下記画像のように処理が走り、プログラムが実行され続けた状態になります

> ターミナルを広く上まで表示している状態  
> <img src="https://i.gyazo.com/83d99ceec634e85eb2ad819196fb40d7.png" alt="gyazo.png" width="450px" />
>
> この二次元バーコードは読み込んでも何も起きません  

- 右下のダイアログに表示されている`ブラウザーで開く`ボタンを押すと、別のタブが開きます
- 誤って消してしまった場合は、ターミナル上部にある`ポート`のタブを開き`8081`番の地球儀マークをクリックすることでも開けます

> 地球儀マークは`転送されたアドレス`列の上にマウスをのせると表示されます  
> <img src="https://i.gyazo.com/b4df50ad7da4af46db619c1ef4b12c84.png" alt="gyazo.png" width="450px" />

- 開くとManus上で表示されたものとほぼ同じアプリが表示されます

> <img src="https://i.gyazo.com/c3d22f9d07b9aba6a059748c0c420d78.png" alt="gyazo.png" width="450px" />

- せっかくですので、スマートフォンの幅で表示してみましょう
- ブラウザをクリックしてキーボードの`F12`、または**右クリックして`検証`**をクリックすると開発者モードというタブが開きます

> 矢印のタブレットアイコンをクリックし、分割項目をお好きなスマートフォンに合わせると、見た目が再現されます  
> <img src="https://i.gyazo.com/17c11a7e872f05c8f360c1316a2a6671.png" alt="gyazo.png" width="450px" />

- ここまで成功していれば、バイブコーディングの準備は万端です。お疲れ様でした

#### 3.2.4.2. ターミナルで実行しているプログラムの停止

最後に実行しているプログラムを停止しましょう。  
ターミナルで実行しているプログラムは、キーボードの`ctrl` + `c`で停止できます。

> 赤枠の中、ターミナル上をクリックしてから、`ctrl` + `c`を押します  
> windowsとmacではcontrolの役割が若干異なりますが、両OSともに`ctrl` + `c`で停止します  
> <img src="https://i.gyazo.com/03706c7d41a2b0bb44afcd0b3930f91b.png" alt="gyazo.png" width="450px" />

- 新規にコマンドを受け付けられる状態になれば成功です

> <img src="https://i.gyazo.com/92b061d71dd916e7aa1082fd8f21e9cf.png" alt="gyazo.png" width="450px" />

## 3.3. Tips

### 3.3.1. Gemini CLIの`shell mode`

Geminiへの入力はGemni CLIを起動して入力、通常のコマンドはGemini CLIを停止して入力する必要があり、実装を進めていると切り替えが手間な時があります。

そのような課題を解決するために、Gemini CLIが起動している状態でも通常のコマンドを実行できるshell modeという機能があります。利用方法は非常にシンプルで、ターミナルを選択した状態で`!`を押下したのち、コマンドを入力するだけです。

> <img src="https://i.gyazo.com/20d657c472e016c8ba524a346276ac64.png" alt="gyazo.png" width="450px" />
>
> 通常`>`と表示される入力欄の赤枠部分が`!`に変化。  
> 入力欄の右上に`shell mode enabled`と表示される。
> shell mode終了時は再度`!`を押す。

この状態であれば、`pnpm --version`などのコマンドがそのまま実行できます。

> <img src="https://i.gyazo.com/e7454d7bfd404a2c682d450d0967c777.png" alt="gyazo.png" width="450px" />
>
> shell modeで`pnpm --version`を入力してEnterを押すと通常のターミナル同様に表示される。  

本ハンズオンでは、ターミナルに二次元バーコードを表示してスキャンする工程が存在するため利用しません。shell modeではターミナル上のログが3行までしか表示されないため、必要な二次元バーコードが見切れてしまうためです。

> <img src="https://i.gyazo.com/932124fedc38ac2653e4df5a1206de8d.png" alt="gyazo.png" width="450px" />
>
> 通常二次元バーコードが表示される`pnpm dev:metro`を実行しても、見切れて表示されない。

今後の参考としてご認識ください。

### 3.3.2. GitHub Copilotについて

本ハンズオン中では使わないため閉じたCodespacesの右サイドバーの領域

> <img src="https://i.gyazo.com/365a1d0d5dada1511f084f93f4cfb50e.png" alt="gyazo.png" width="450px" />

こちら、GitHub Copilotと呼ばれるGitHubのAIエージェントです。GitHub Codespacesを起動するとデフォルトでインストールされており、サッと実装する分には非常に便利です。
AIモデル自体はGPTやGeminiなどを流用し、GitHub自体がAIモデルを構築しているわけではありません。

ただし、無料だと月間50回というチャットの制限があり、たくさん実装すると50回はあっという間に使い切ってしまうため、本ハンズオンでの採用は見送ることとしました。

### 3.3.3. pnpmとは?（結構難し目で興味ある方向け）

後半のコマンド入力で何度も出てきた`pnpm`。
これは、package manager（パッケージマネージャ）と呼ばれる道具の一種です。

#### package manager?

非常に端的にいうと、**「アプリ開発に必要な“部品”をまとめて管理してくれる道具」**です。  
実際にアプリ開発をする場面でも、0からプログラムを書き始めることはなく、第三者がまとめてくれた便利な道具（ライブラリやフレームワークと呼ばれます）を利用します。  
その第三者が作った道具を開発環境に持ってきたり、一度作ったアプリを設計書に従って必要な道具を持ってきたりしてくれるのがpackage managerであり、pnpmもその一種です。

#### ハンズオン中に何を実施していたのか？

> `which pnpm`  
>
> - whichは場所を聞くコマンド。すなわちpnpmがどこにあるかを確認しました。  
> - pnpmがCodespaceに入っていないとこの先の開発ができないため、ちゃんと入っていることを確認したのです。

> `pnpm --version`  
>
> - 多くの場合、`--version`でバージョンを確認できます。  
> - pnpmが入っていることは確認しましたが、念のため古すぎないか確認しました。

> `pmpm dev:metro`  
>
> - 実はアプリの設計書にpnpmから`dev:metro`というコマンドを実行すると、ブラウザから確認できることが書いてあるのでそれを実行しました。

#### 設計書はどこにあるのか？

何度か出てきた設計書という表現、今回のアプリでは`package.json`というファイルに記述してあります。

- [package.jsonのサンプル](./samples/sample_package.json)

例としてはこのような感じ（実際にManusが作成したpackage.json）。  
どのような意味を持つのか、そもそもJSONとは何かなど、気になることは生成AIに聞いてみるとさらに学びになります。  
ぜひお時間がある時に実施してみましょう。

## 3.4. 本セッションのまとめ

本セッションでは、`Manusで作成した雛形をGitHub Codespacesに移植`し、`Codespaces上でGemini CLIを利用してバイブコーディングするための準備`を行いました。Manusで作成したテンプレートを利用して、ここからはManusのトークン制限に縛られずに自由に開発ができます（Codexの従量課金は発生しますが）。

なれない操作が多く混乱する部分もあったかもしれませんが、2〜3回繰り返せば慣れてきますし、初回のみ発生する作業もありますので、次回以降はよりスムーズに実行できるでしょう。

また、ある程度手順が頭に入った段階で、裏側ではどのような処理が行われているかを生成AIなどに聞くことでより理解が深まります。お時間のある時に実施してみてください

---

このページの内容は以上です。  
[次ページ](04.md)  
[◀ 目次ページ](./readme.md)
