# 2. Manusで旅行記録アプリの雛形を作成し、スマホで動かす（20 min / 50 min）

まずはManusを利用して、旅行記録アプリの雛形となるような機能の一部分を作成、スマートフォン上で動作させるところまで進めます。  
AIエージェントに一度に大量に実装させると、正確に実装しきれない場合があるため、段階的に実装を進めていく意図です。  
余裕のある方は、`2.3. Tips`を読んでいただくことでより理解が深まるかと思います。

## 2.1. このセクションの目標・期待される結果

> 旅行記録アプリの見た目と一部機能の作成

- Manus側で、**日時を取得してメモを残せる**機能を持ったアプリが実装できる
- Expo側で二次元バーコードを読み込み、作成したアプリを動作させることができる

> [!NOTE]
> AIエージェントに実装させる場合、どうしてもアウトプットに多少の差異が発生します。  
> ですので、目指している`期待される結果`をイメージして進めていただくことで、成功・失敗の判断がしやすくなりますので、意識して進めましょう。

## 2.2. ハンズオン

### 2.2.1. Manusでモバイルアプリの雛形を作成

`1.` Manusにアクセスし、AIに指示文（プロンプト）を与える

- [こちら](https://manus.im/)からManusにアクセスします
- チャット欄に下記文章をコピーペースト。また`📱 Develop apps`のボタンを押します

> [!WARNING]
> 長いです。◻︎2つのアイコンをクリックしてコピーしましょう

```md
以下の要件を満たすアプリを実装してください。

## 目的
Web（Expo Web）とモバイルの両方で動作する
「チェックイン・フィールドノート」アプリの最小構成を作成する。

## 技術要件
- Expo（Managed Workflow）を使用する
- Expo Router を用いて画面遷移を構成する
- 状態管理は React 標準を使用する
- データは端末ローカルに保存する（AsyncStorage）

- check_inを登録後、登録する関数の中でstateにcheck_inを追加して画面更新を行う（useEffectで管理しないこと）

## 機能要件
- チェックイン作成画面
  - メモ（テキスト入力）
  - チェックイン日時は自動付与
  - 登録後に再度stateを更新し、登録した内容を画面に反映
- チェックイン一覧画面
  - 日時とメモの一覧表示
- チェックイン詳細画面
  - 日時とメモを表示

### テスト
- 入力 -> 登録 -> 画面反映までのE2Eテストを実行する

## 制約
- センサー（位置情報、カメラ、Haptics、バックグラウンド処理）は使用しない
- Webで動作確認できることを最優先とする
- UIはシンプルでよい

## 成果物
- ディレクトリ構成
- 主要コンポーネントの実装コード
- 起動および動作確認手順
```

> <img src="https://i.gyazo.com/2b883b4e9539b40cb2de715f30b49483.png" alt="gyazo.png" width="450px" />
>
> 赤枠の中がモバイルアプリを開発するためのボタン

- 次の画像のような状態で`↑`ボタンを押す、もしくは`Enter`を押すことで開発がスタートします

> <img src="https://i.gyazo.com/3159501d7f9cc2d7d9d4e01b2cee724f.png" alt="gyazo.png" width="450px" />

- 下記画像のように、有料プランへのアップデートを推奨される場合もありますが`Try lite anyway`を選択して問題ありません

> <img src="https://i.gyazo.com/5a027afd24cf0aa90b5ce6c96ed5bfe4.png" alt="gyazo.png" width="450px" />

- 開発が始まると、画像のようにManusが手順を踏んで実装を進めます

> <img src="https://i.gyazo.com/7472b33522e77d99ebf44ff573da4a74.png" alt="gyazo.png" width="450px" />
>
> todoとしてやるべきことをタスク化している様子

- **特にエラーなどなければ、5~6分程度で実装が完了します**

実装されたアプリを触ってみましょう。**ブラウザ上で動作確認できます**。  
もしアプリが表示されていない場合は、`➡️Preview`のボタンを押すと表示されます。  
**日時を取得してメモを残せる**機能が実装されていれば成功です。

> <img src="https://i.gyazo.com/207cc44486d92304038cefc609dadcc9.png" alt="gyazo.png" width="450px" />
>
> アプリの見た目は人によって異なります  
> 今回実装されたアプリでは右下の`+`ボタンから登録できるようです

↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓

> <img src="https://i.gyazo.com/e4d3449a3f041312835029b1b95c6e96.png" alt="gyazo.png" width="450px" />
>
> 日時が取得され、`Hello STATION Ai`というメモを登録できています

### 2.2.2. 作成したアプリをExpo Goで動かす

実際にスマートフォン上で動かしてみましょう。**Expo Goで動かすための二次元バーコードも表示されています**。

> <img src="https://i.gyazo.com/5f1580ea94d221d6a3f66139e66ddaf2.png" alt="gyazo.png" width="450px" />
>
> 二次元バーコードが表示されているのでスマホでスキャンしましょう

`1.` 二次元バーコードの読み込み

- ご自身のスマートフォンから二次元バーコードをスキャンしてください

> <img src="https://i.gyazo.com/590f272b5728ffe4e1b44ca9bb487e61.jpg" alt="gyazo.jpg" width="450px" />

- `Expo Goで開く`のボタンを押してください

> [!WARNING]
> 極稀に下記写真のようなエラーが発生します。  
> その場合、Expo Goを一度スマホからタスクキルし、Manus側も更新。
> 再度、二次元バーコードをスキャンすることで開けました。  
> <img src="https://i.gyazo.com/b4d165d1cf2a546e170ee304c2c9474a.png" alt="gyazo.png" width="450px" />


`2.` Expo Go上で動作確認

- Expo Goで開いて30秒程度待つと、ブラウザで確認できていた画面と同様の画面が開きます

> <img src="https://i.gyazo.com/26742d8121b4a22865f6b869bc788627.jpg" alt="gyazo.jpg" width="450px" />
>
> スマホ側でセットアップが進みます

↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓

> <img src="https://i.gyazo.com/22d0185aed1c8735811253139c84f8b0.jpg" alt="gyazo.jpg" width="450px" />
>
> スマホ側で同様のアプリが表示されれば成功です！  
> お疲れ様でした！

## 2.3. Tips

- 実装本編と関連するものの、難易度や時間の都合上省略している内容を記載しています
- お時間が余った方は読んでみてください

### 2.3.1. Markdown形式

- Markdown（マークダウン）形式は、文章を読みやすく書きつつ、簡単な記号で構造や装飾を表現できる記法です
- エンジニアのドキュメント、README、ブログ、メモなどで広く使われています
- 生成AIに指示を出す際のプロンプトや、生成AIが生成する文章でも利用されています

> [!NOTE]
> 本資料`GitHub`もMarkdown形式で記述しています。段落構造、文字の装飾、リンクなどを簡単に表現できるので、慣れて活用してみましょう。

<details><summary>Markdown形式の例</summary>

## 1. 見出し（Heading）

`#` の数で見出しレベルを表します。

```markdown
# 見出し1
## 見出し2
### 見出し3
```

表示例：

# 見出し1

## 見出し2

### 見出し3

---

## 2. 段落・改行

- 空行で段落が分かれます
- 改行だけでは段落は変わりません

```markdown
これは1つ目の段落です。

これは2つ目の段落です。
```

---

## 3. 強調（太字・斜体）

```markdown
*斜体*
**太字**
***太字＋斜体***
```

表示例：
*斜体*
**太字**
***太字＋斜体***

---

## 4. 箇条書き（リスト）

### 箇条書き（順不同）

```markdown
- りんご
- みかん
  - 小みかん
```

- りんご
- みかん

  - 小みかん

### 番号付きリスト

```markdown
1. 手順1
2. 手順2
3. 手順3
```

1. 手順1
2. 手順2
3. 手順3

---

## 5. リンク

```markdown
[Google](https://www.google.com)
```

表示例：
[Google](https://www.google.com)

---

## 6. 画像

```markdown
![代替テキスト](画像のURL)
```

例：

```markdown
![ロゴ](https://example.com/logo.png)
```

---

## 7. コード表記

### インラインコード

```markdown
`const x = 1`
```

表示例：
`const x = 1`

### コードブロック

````markdown
```ts
const message = "Hello Markdown";
```
````

表示例：

```ts
const message = "Hello Markdown";
```

---

## 8. 引用

```markdown
> これは引用です
```

> これは引用です

---

## 9. 区切り線（水平線）

```markdown
---
```

---

## 10. チェックリスト（ToDo）

```markdown
- [x] 完了
- [ ] 未完了
```

- [x] 完了
- [ ] 未完了

---

## 11. 表（テーブル）

```markdown
| 名前 | 年齢 |
|------|------|
| 太郎 | 20 |
| 花子 | 22 |
```

| 名前 | 年齢 |
| -- | -- |
| 太郎 | 20 |
| 花子 | 22 |

</details>

### 2.3.2. Vibe Cordingを始める前の注意点

今回はManusを利用してVibe Cordingをスタートしましたが、他のAIコーディングエージェントで実装する場合に必要となる作業を肩代わりしてくれています。  
特に、Gemini CLIのような白紙からスタートするタイプのエージェントを利用する場合、注意した方が良いポイントをまとめています。

> [!TIP]
> **計画を立ててから実装を始める**

- 一般的なプログラミングでは、いきなり見た目や機能を実装し始めるのではなく、**見た目と機能の全体像に関して見通しを立ててから開発に入ることが重要**です。
- **AIコーディングエージェントを利用した実装でもそれは例外ではありません**。必ず計画を立ててから実装することが必要となります。
- **Manusの場合、実装に入る前に`design.md`, `todo.md`というファイルを作成**することで計画を立てています。

> <img src="https://i.gyazo.com/e4ebe13f1c73ae7a115ef9d4ba893e9c.png" alt="gyazo.png" width="450px" />

例：

実際にManusが作成した`design.md`, `todo.md`の例を下記に載せています

- [design.md](./samples/sample_design.md)
- [todo.md](./samples/sample_todo.md)

> [!TIP]
> **白紙の状態から始めない**

- 実際の開発において、白紙の状態から始めてプログラムを書き始めることはほぼありません
- モバイルアプリにせよ、webアプケーションにせよ、何らかの雛形（フレームワーク、ライブラリなどと呼んでいます。フレームワークは全部いり、ライブラリはパーツなイメージ）を準備して、その雛形を改変する形で実装します
  - カレーを作る際、カレー粉から一からつくらずルーやレトルトを買ってきて作るのに近いです。
  - ルーやカット野菜を利用するのがライブラリ、レトルトを買ってきてスパイスやライスにこだわったり、追加の具を入れるのがフレームワークのイメージ
  - **なれていない人が1から作るより、むしろ早く美味しくできる**のもイメージに近いです
- AIは、この雛形を生成するのがあまり上手ではありません。フレームワークは日々更新されるのに対し、AIの知識は学習された地点で止まっているためです。

> 今回のモバイルアプリの例：  
> プロンプトにも入力した`React Native`, `Expo`というフレームワークで実装しています。
> これを準備するためには、ターミナルに以下入力して実行することで作成されます。

```sh
npx create-expo-app my-expo-app
```

- もちろん、**フレームワークやライブラリを利用してアプリの雛形を準備するのも、ある程度の知識が必要**です。本ハンズオンではその立ち上げ部分をManusに手伝ってもらっています
- Manusは内部的に類似したコマンドを実行するか、すでに保持しているテンプレートから雛形を立ち上げることで、安定して作成できるようにしています。
- プロンプトで念の為、`アプリはReact NativeとExpoの構成で実装してください。`という文言を入れていますが、`Develop apps`をonにすれば再現性高く実行できます

### 2.3.3. ManusでのVibe Cordingのガードレール

AIに実装をさせる以上、どうしても差異が発生することは避けられません。とはいえ、**絶対に外してほしくない要件**というものも存在しており、そのためのガードレールを敷くという考え方がVibe Cordingを本格的に開発に利用している方々には一般的になってきました。  
今回利用しているのが**テストを行う**というやり方です。

プロンプトに記載してある文言

```md
### テスト
- 入力 -> 登録 -> 画面反映までのE2Eテストを実行する
```

この部分で、ManusのAI自身に正しい挙動を取ることを検証させています。

> [!CAUTION]
> tbd 画像撮り直し。  
> このように、Manus側でアプリケーションを操作し、想定される挙動を取ることを確認。  
> 想定外の挙動をとった時は原因を推定し、修正するというタスクを課しています。  
> 本来、このようにアプリを自動操作し、挙動を検証する手順を整えるのは大変なのですが、Manusはよしなに実施してくれるのでUIの実装という面では強みがあるといえます。

実際に、何度か当該アプリケーションを実装すると、メモを登録しても画面に反映しないという不具合が発生していました。  
どうしても外したくない要件については、テストを実行してみるのも良い選択と言えます。

### 2.3.4. Manusの消費トークンとAIコーディングエージェント

Manusに限らず、AIコーディングエージェントは`トークン`と呼ばれる通貨のようなものを消費して、アプリの生成などのタスクを実行します。

> <img src="https://i.gyazo.com/9f182f1caa9bc0c189fe56077904452d.png" alt="gyazo.png" width="450px" />
>
> 参考として、今回の実装に消費したトークン。  
> Manusの場合、おおよそ1つの出力で150 ~ 200程度消費。  
> 実装に手間取った場合は、さらに多くのトークンを消費する場合もあります。

また、Manusのフリープランでは、初期に1,000トークン。月間1,500までのデイリートークンという枠が決まっています。  
そのため、Manusで無料のまま際限なくVibe Cordingができるわけではありません。

## 2.4. 本セッションのまとめ

本章では`Manus`と`Expo Go`というサービスを利用してモバイルアプリのベースを作成して動かすところまでを実行しました。  
2つのサービスを利用したため混乱するところもあったかもしれませんが、それぞれの役割は以下のとおりです。

- Manus：自律的に動作するAIエージェント
  - モバイルアプリの雛形からメモを作成・登録するところまでを計画
  - 計画に従って実装。動作するところまで作成
- Expo Go：モバイルアプリを簡単に実装するための仕組み
  - Manusが実装したアプリをスマホのアプリで読み込み
  - スマホ上で実際に動作させるところを実行

---

このページの内容は以上です。  
[次ページ](03.md)  
[◀ 目次ページ](./readme.md)
