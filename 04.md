# バイブコーディングでアプリに機能を追加する

Manusで作成したアプリのソースコードをコーディングエージェントに改修させて機能追加をしてみましょう。

## 1 このパートで作るもの

> 実際の天気データを反映した天気予報アプリの実装

- Codex IDEでアプリを改変。実際の天気データを取得するアプリが実装できる
- GitHub Codespacesから二次元バーコードを発行し、Expo Goで動かすことができる

## 4.2. ハンズオン

### 4.2.1. Vibe Cording｜天気データの取得

それではVibe Cordingを初めていきましょう。  
繰り返しとなりますが、大切なのは計画を立ててから実行することです。  
実際にVibe Cordingする中で計画から実行までの流れを体験しましょう。

#### 4.2.1.1. `AGENTS.md`での計画立案

#### 4.2.1.1. `Chat`での計画立案

- Codexには`Chat` / `Agent` / `Agent（full access）`の3つのモードがあります
- `Chatモード`で最初に開発の計画を立てて、`Agent（full access）モード`で実行をする流れが基本となります

> [!IMPORTANT]
> Codexでは基本的に`Chatモード`で作りたいアプリケーションの仕様を考え、確認してから、`Agent（full access）モード`で実行する流れを意識して下さい。

> [!TIP]
> Codexではない別のツールで`Planモード`/`Actモード`の二つのモードを切り替えながら進めるツールもあり、**最初から実行ではなく、計画を立ててから実行する** 流れが基本となっています。


以下のプロンプト（AIに指示を出す文章）をコピーし、Codexのフォームを貼り付けて少し編集しましょう。

> ![](https://i.gyazo.com/4390b212bd57b99431ed79d7b63cf980.png)

```sh
open-meteoで実際の天気データを取得するように変更してほしいです。
アプリに表示されるデータもopen-meteoで取得する形式に合わせてください。
実装までに必要な手順はタスク化してください。
```

そのままではなく、`水色を基調`や`東京駅周辺`の箇所は、 **何か別の色や地名に変えてみましょう。**

編集後、Chatモードになっていることを確認して送信してみましょう。

送信すると、AIがWebアプリの開発計画を考えてくれて、計画が表示されます。

表示が狭くなる場合はターミナルエリアを小さくしたり表示を工夫しましょう。

#### 4.2.1.2. `Agent`での実装

- （todo.mdの更新）

AIから開発の方針が表示されるので、 **方針を確認（注）** し、"この方針で進めて良いですか？"などと表示されたら、`Agent（full access）モード`に切り替えてください。

次のプロンプトを入力してAIに作業をスタートさせましょう。

```sh
整理したタスクをtodo.mdに同様の形式で追記して、開発をスタートしてください。
開発が終わったら再度todo.mdを確認し、完了状況を更新してください
```

> Agent（full access）モードに切り替わえ忘れないように
> ![](https://i.gyazo.com/0518dae5b648f93eddc53439d23bd98d.png)
> 
> ![](https://i.gyazo.com/b773594bbc857e0aff0a3e7a8bc69505.png)

:::note info
（注）"AIが立てる方針の判断が出来ない"という声が聞こえてきそうですね。

取り急ぎ詳細は **分からなくても大丈夫です。** 今回のようなシンプルなアプリケーションはAIがよしなにやってくれるようになってきました。 **ただ、どんなことが書いているか読んでみる意識** はしてみましょう。
今後AIを使って何かを仕事をしていく際にもAIがやろうが責任はアウトプットを出すご自身や会社のものとなりますので、その時に"知りませんAIがやりました"だとお客さんは納得しないでしょう。

開発に限らずですが、ベースの知識がないと判断は出来ないので、方針についてAIとディスカッション出来るようになるには自身の解像度の高さを上げるしかないです。
:::


開発がスタートし、エディタエリアにコードが書かれていきます。

> ![](https://i.gyazo.com/0c01d7833b2ee93e49b1efa5b0d8f876.gif)

### 3-3. 実行許可と権限付与（紹介のみ）

`Chatモード`や`Agentモード`のまま作業をさせようとすると、Codexが作業の途中で、ファイルの変更をしてもいいですか？と許可を求めてきます。

その場合はAppove（承認）してあげると、ファイル編集などを実行してくれます。もし`Agent（full access）モード`にせず進めてしまった人はこのような緑色の承認ボタンが出たら許可してあげてください。

> approve（承認）
> ![](https://i.gyazo.com/bdeca65ffc18edb52ffe3311e97b02d4.png)

慎重にやる場合はこのように毎回許可を出していき、承認のハンコ（許可）がないと先には進ませないといったやり方もできます。

> ![](https://i.gyazo.com/e79d204e1a1de3051b1d9794fd7caf46.png)

ただこのやり方は確認の手間が大きく、スピードに乗って開発できないですね。

> ![](https://i.gyazo.com/957af6f16b631696362aefc09b71b93a.jpg)

今回は最初からこの許可を求めることをせずに **全部おっけー！** という状態になる`Agent（full access）モード`で進めています。

### 4.2.2. Expoでの確認

- （npx expo start --tunnel）

#### 練習3. `（ctrl + c）`: サーバー停止

サーバープログラムが起動していると、そのターミナルは次のコマンドが入力できません。

また、**AIがアプリケーションを作成してもサーバーの再起動をしないとアプリケーションが更新されない場合もあります**。

これらを踏まえ、起動したサーバーを一度停止する必要があります。

ターミナルエリアをクリックして選択している状態で、`コントロールキー+C`でサーバーを停止できます。

> コントロールキーとキーボードのCを同時押しです。
>
> <img src="https://i.gyazo.com/7d071f5fac766bd721d4b556dcbf83fc.gif" alt="gyazo.png" width="450px" />

停止するとまたlsなど別のコマンドが入力できます。

再度、`npx expo start --tunnel`コマンドを実行してサーバー起動 => `ctrl`+`c`でサーバー停止を繰り返して操作に慣れましょう。

## 4.3. チャレンジ課題｜選択実装（20 min / 120 min）

- プラス1機能を選択実装
  - 現在地ベースの自動ロケーション検出
  - 地図のUIから表示地点を選択
  - 時間別/日別のグラフ表示
  - その他好きな機能を実装
- PC上での一時確認について（`pnpm dev:metro`で発行されるURLにアクセス）

> [!TIP]
> 更新する範囲を制限する（AIにいきなり大胆に変更させない）

大胆には変更しないようにしましょう

> [!TIP]
> 更新したら必ず確認する

一見正しく実装しているように見えても嘘をつく場合があります

## 4.4. Tips

### 4.4.1. Gemini CLIにおけるVibe Cordingのガードレール

> [!CAUTION]
> tbd about AGENTS.md

## 4.5. 本セッションのまとめ

本セッションではGitHub Codespacesを利用したVibe Cordingを体験してみました。  
また、APIという仕組みを利用してリアルタイムなデータを取得することも実践しました。

---

このページの内容は以上です。  
[次ページ](04.md)  
[◀ 目次ページ](./readme.md)
